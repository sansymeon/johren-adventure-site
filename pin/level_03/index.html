<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Johren | Pin Details</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Pin details" />
  <style>
    body{margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;background:#f6f6f4;color:#222;line-height:1.6}
    .wrap{max-width:520px;margin:0 auto;padding:56px 20px 64px}
    .card{background:#fff;border-radius:18px;box-shadow:0 6px 18px rgba(0,0,0,.08);padding:22px}
    h1{font-size:18px;margin:0 0 10px;opacity:.85}
    .name{font-size:26px;margin:0 0 10px;text-align:center}
    .row{display:flex;justify-content:space-between;gap:12px;border-top:1px solid rgba(0,0,0,.08);padding:10px 0}
    .k{opacity:.7}
    .v{text-align:right}
    .btns{display:flex;flex-direction:column;gap:10px;margin-top:16px}
    .btn{display:inline-block;text-align:center;padding:12px 14px;border-radius:999px;text-decoration:none;font-weight:700}
    .primary{background:#111;color:#fff}
    .secondary{background:#fff;color:#111;border:1px solid rgba(0,0,0,.18)}
    .hide{display:none}
    .tiny{margin-top:10px;font-size:12px;opacity:.7;text-align:center}
  </style>
</head>
<body>
  <main class="wrap">
    <div class="card">
      <h1 id="areaTitle">Pin details</h1>
      <div class="name" id="pinName">Loadingâ€¦</div>

      <div class="row hide" id="rowHours">
        <div class="k">Hours</div>
        <div class="v" id="hoursVal"></div>
      </div>

      <div class="row hide" id="rowDays">
        <div class="k">Business days</div>
        <div class="v" id="daysVal"></div>
      </div>

      <div class="row" id="rowCoords">
        <div class="k">Location</div>
        <div class="v" id="coordsVal"></div>
      </div>

      <div class="btns">
  <!-- Merchant link (will be set by JS when available) -->
  <a class="btn primary hide" id="visitLink" href="#" target="_blank" rel="noopener">Open merchant link</a>

  <!-- Demo site (always available) -->
  <a class="btn secondary" id="demoLink"
     href="/pin/level_03/demo_site/"
     target="_blank" rel="noopener">Demo site</a>

  <a class="btn secondary hide" id="lineFollow" href="#" target="_blank" rel="noopener">Follow on LINE</a>
  <a class="btn secondary" id="backLevel2" href="#">Back</a>
</div>

      <div class="tiny">ID: <span id="pinId"></span></div>
    </div>
  </main>

  <script src="/js/area-config.js"></script>
  <script>
    (function(){
      const params = new URLSearchParams(location.search);
      const areaKey = (params.get("area") || "").trim();
      const id      = (params.get("id") || "").trim();

      const cfg = window.MAP_CONFIG?.[areaKey];
      const pin = cfg?.pins?.find(p => p.id === id);

      const areaTitle = document.getElementById("areaTitle");
      const pinName   = document.getElementById("pinName");
      const pinId     = document.getElementById("pinId");

      const rowHours  = document.getElementById("rowHours");
      const rowDays   = document.getElementById("rowDays");
      const hoursVal  = document.getElementById("hoursVal");
      const daysVal   = document.getElementById("daysVal");

      const coordsVal = document.getElementById("coordsVal");

      const visitLink = document.getElementById("visitLink");
      const lineFollow= document.getElementById("lineFollow");
      const backLevel2= document.getElementById("backLevel2");

      if (!cfg) {
        areaTitle.textContent = "Unknown area";
        pinName.textContent = "Missing area config";
        document.getElementById("rowCoords").classList.add("hide");
        backLevel2.href = "/";
        pinId.textContent = id || "(none)";
        return;
      }

      areaTitle.textContent = cfg.title || areaKey || "Pin details";

      if (!pin) {
        pinName.textContent = "Pin not found";
        document.getElementById("rowCoords").classList.add("hide");
        backLevel2.href = `/pin/level_03/?area=${encodeURIComponent(areaKey)}&level=3&id=${encodeURIComponent(id)}`;
        pinId.textContent = id || "(none)";
        return;
      }

      pinName.textContent = pin.nameEn || pin.name || "(no name)";
      pinId.textContent = pin.id;

      // coords always available in your data
      coordsVal.textContent = `${pin.lat.toFixed(5)}, ${pin.lng.toFixed(5)}`;

      // Optional info fields (only show if present)
      if (pin.hours) { hoursVal.textContent = pin.hours; rowHours.classList.remove("hide"); }
      if (pin.days)  { daysVal.textContent  = pin.days;  rowDays.classList.remove("hide"); }

      // Optional merchant link
      if (pin.link) {
        visitLink.href = pin.link;
        visitLink.classList.remove("hide");
      }

      // Optional LINE follow
      if (pin.line) {
        lineFollow.href = pin.line;
        lineFollow.classList.remove("hide");
      }

      backLevel2.href = `/pin/level_02/?area=${encodeURIComponent(areaKey)}&level=2&id=${encodeURIComponent(pin.id)}`;
    })();
  </script>
</body>
</html>
